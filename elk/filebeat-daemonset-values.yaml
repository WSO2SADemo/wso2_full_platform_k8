# elk/filebeat-daemonset-values.yaml
daemonset:
  enabled: true

  # All settings for the daemonset pod must go *inside* this block.

  filebeatConfig:
    filebeat.yml: |
      # --- THIS IS THE MISSING BLOCK ---
      # This tells Filebeat to read all container logs from the node.
      filebeat.inputs:
      - type: container
        paths:
          - /var/log/containers/*.log
        include_lines: ['(apimMetrics):']
      # --- END OF MISSING BLOCK ---

      filebeat.processors:
        - add_kubernetes_metadata:
        - drop_event:
            when:
              not:
                equals:
                  kubernetes.namespace: "apim-gw"

      output.logstash:
        hosts: ["logstash-logstash.elk.svc.cluster.local:5044"]

  # ---
  # We do not need extraEnv, envFrom, or extraVolumes
  # because the chart automatically provides them.
  # ---