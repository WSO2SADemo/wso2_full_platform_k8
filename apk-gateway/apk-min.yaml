wso2:
  apk:
    webhooks:
      validatingwebhookconfigurations: false
      mutatingwebhookconfigurations: false
      conversionwebhookconfigurations: false
    auth:
      enabled: true
      enableServiceAccountCreation: true
      enableClusterRoleCreation: true
      serviceAccountName: wso2apk-platform
      roleName: wso2apk-role
    listener:
      hostname: "kgw.airline.wso2.com"
      port: 9095
    idp:
      issuer: "https://cp.wso2.com:443/oauth2/token"
      usernameClaim: "sub"
      organizationClaim: "organization"
      groupsClaim: "groups"
      consumerKeyClaim: "clientId"
      organizationResolver: "controlPlane" # controlplane,none
      # tls:
      #   secretName: "wso2apk-idp-certificates"
      #   fileName: "idp.crt"
      signing:
        jwksEndpoint: "http://acp-wso2am-acp-service.apim-cp.svc.cluster.local:9763/oauth2/jwks"
        # secretName: "wso2apk-idp-certificates"
        # fileName: "idp.crt"
    cp:
      enabledSubscription: true
      # APK Gateway connects to APK Agent (not directly to Control Plane)
      # Agent service in apim-kgw namespace
      host: "apim-apk-agent-service.apim-kgw.svc.cluster.local"
      skipSSLVerification: true
      persistence:
        type: "K8s"
    dp:
      enabled: true
      gateway:
        listener:
          hostname: "kgw.airline.wso2.com"
      configdeployer:
        enabled: true
        deployment:
          replicas: 1
          imagePullPolicy: Always
          image: wso2/apk-config-deployer-service:1.3.0
      adapter:
        deployment:
          replicas: 1
          imagePullPolicy: Always
          image: wso2/apk-adapter:1.3.0
          logging:
            level: "DEBG"
          configs:
            enableGatewayClassController: false
      commonController:
        deployment:
          replicas: 1
          imagePullPolicy: Always
          image: wso2/apk-common-controller:1.3.0
      ratelimiter:
        enabled: true
        deployment:
          replicas: 1
          imagePullPolicy: Always
          image: wso2/apk-ratelimiter:1.3.0
      gatewayRuntime:
        deployment:
          replicas: 1
          router:
            imagePullPolicy: Always
            image: wso2/apk-router:1.3.0
          enforcer:
            imagePullPolicy: Always
            image: wso2/apk-enforcer:1.3.0
            env:
              TOKEN_REVOCATION_ENABLED: "true"
              LOG_LEVEL: "DEBUG"
            configs:
              # gRPC connection keepalive settings
              grpc:
                keepAliveTime: 30s
                keepAliveTimeout: 10s
                permitWithoutStream: true
              apiKey:
                enabled: false
                issuer: "https://cp.airline.wso2.com:443/oauth2/token"
idp:
  enabled: false
  listener:
    hostname: "mbcp.idp.wso2.com"
  database:
    driver: "org.h2.Driver"
    url: "jdbc:h2:./repository/database/WSO2AM_DB;DB_CLOSE_ON_EXIT=FALSE"
    host: "localhost"
    port: 0
    databaseName: "WSO2AM_DB"
    username: "wso2carbon"
    secretName: "apk-db-secret"
    secretKey: "DB_PASSWORD"
    validationQuery: "SELECT 1"
    validationTimeout: 250
  idpds:
    configs:
      issuer: "https://mbcp.idp.wso2.com/token"
      keyId: "gateway_certificate_alias"
      hostname: "mbcp.idp.wso2.com"
      loginPageURl: "https://mbcp.idp.wso2.com:9095/authenticationEndpoint/login"
      loginErrorPageUrl: "https://mbcp.idp.wso2.com:9095/authenticationEndpoint/error"
      loginCallBackURl: "https://mbcp.idp.wso2.com:9095/authenticationEndpoint/login-callback"
    deployment:
      replicas: 1
      imagePullPolicy: Always
      image: wso2/apk-idp-domain-service:1.3.0
  idpui:
    deployment:
      replicas: 1
      imagePullPolicy: Always
      image: wso2/apk-idp-ui:1.3.0
    configs:
      idpLoginUrl: "https://mbcp.idp.wso2.com:9095/commonauth/login"
      idpAuthCallBackUrl: "https://mbcp.idp.wso2.com:9095/oauth2/auth-callback"

gatewaySystem:
  enabled: true
  enableServiceAccountCreation: true
  enableClusterRoleCreation: true
  serviceAccountName: gateway-api-admission
  applyGatewayWehbhookJobs: true
  deployment:
    image: registry.k8s.io/gateway-api/admission-server:v1.0.0
    imagePullPolicy: Always

certmanager:
  enabled: true
  enableClusterIssuer: true
  enableRootCa: true
  rootCaSecretName: "apk-root-certificate"

postgresql:
  enabled: false

redis:
  enabled: true
  architecture: standalone
  fullnameOverride: redis
  auth:
    enabled: false
    usePasswordFiles: false

global:
  security:
    allowInsecureImages: true
